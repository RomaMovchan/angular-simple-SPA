angular.module("phonecatApp",["ngRoute","phoneList","phoneDetail","busketItem"]),angular.module("phonecatApp").controller("phonecatAppController",[function(){var e=this;e.showBusket=!1}]);
angular.module("phonecatApp").config(["$locationProvider","$routeProvider",function(e,o){e.hashPrefix("!"),o.when("/phones",{template:"<phone-list></phone-list>"}).when("/phones/:phoneId",{template:"<phone-detail></phone-detail>"}).otherwise("/phones")}]);
angular.module("phoneList").directive("addToCart",["busketItemService",function(e){return{restrict:"A",link:function(i,n,t){n.on("click",function(n){i.phone.instock>0?(i.phone.instock-=1,e.set(i.phone.cart_id)):i.isDisabled=!1,i.$digest()})}}}]);
angular.module("phoneList",[]);
angular.module("phoneList").component("phoneList",{templateUrl:"phone-list/phone-list.template.html",controller:["phoneListService",function(e){var n=this;n.orderProp="category",n.phones=[],e.get().then(function(e){n.phones=e})}]}),angular.module("phoneList").service("phoneListService",["$http","$q",function(e,n){function t(){return e.get("phones/phones.json").then(function(e){return n.when(e.data)})}return{get:t}}]);
angular.module("phoneDetail",["ngRoute"]);
angular.module("phoneDetail").component("phoneDetail",{templateUrl:"phone-detail/phone-detail.template.html",controller:["$http","$routeParams",function(e,t){var n=this;n.setImage=function(e){n.mainImageUrl=e},e.get("phones/"+t.phoneId+".json").then(function(e){n.phone=e.data,n.setImage(n.phone.images[0])})}]});
angular.module("busketItem",[]);
angular.module("busketItem").service("busketItemService",["$q",function(e){function t(){return null===localStorage.getItem(a)&&localStorage.setItem(a,JSON.stringify({})),e.when(JSON.parse(localStorage.getItem(a)))}function r(e){null===localStorage.getItem(a)&&localStorage.setItem(a,JSON.stringify({}));var t=JSON.parse(localStorage.getItem(a));t.hasOwnProperty(e)?t[e]+=1:t[e]=1,localStorage.setItem(a,JSON.stringify(t))}var a="cart";return{get:t,set:r}}]);
angular.module("busketItem").directive("itemsInBusket",function(){return{restrict:"A",templateUrl:"busket-items/busket-item.template.html",controller:["busketItemService","phoneListService",function(t,e){var n=this;n.phoneItems=[],n.items=[],n.summ=0,n.quant=0,e.get().then(function(t){return n.phoneItems=t,t}).then(function(){return t.get()}).then(function(t){angular.forEach(t,function(t,e){angular.forEach(n.phoneItems,function(u){parseInt(e)===u.cart_id&&(u.qty=t,n.items.push(u),n.summ+=u.price*u.qty,n.quant+=u.qty,console.log(u.qty))})})})}],controllerAs:"busket",link:function(t,e,n){}}});